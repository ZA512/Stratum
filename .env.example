# ==========================
# Stratum - Configuration Docker / Production
# Copier ce fichier en .env et adapter les valeurs.
# ==========================

# ---- Application Ports (peuvent être modifiés si collision) ----
FRONTEND_PORT=3000
BACKEND_PORT=4001
POSTGRES_PORT=5432

# ---- Postgres (service interne docker) ----
POSTGRES_USER=stratum
POSTGRES_PASSWORD=CHANGE_ME_STRONG
POSTGRES_DB=stratum_db
POSTGRES_HOST=postgres
POSTGRES_SCHEMA=stratum

# ---- JWT / Auth ----
JWT_SECRET=CHANGER_CE_SECRET_LONG_ET_RANDOM
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL_MS=90d
RESET_TOKEN_TTL_MS=3600000
INVITATION_TTL_MS=604800000

# ---- Migrations automatiques ----
# true => le container backend lance `prisma migrate deploy` avant de démarrer
AUTORUN_MIGRATIONS=true

# ---- Frontend ----
# URL publique de l'API consommée par le frontend
# En mode dev local via compose: http://localhost:${BACKEND_PORT}/api/v1
NEXT_PUBLIC_API_URL=http://localhost:4001/api/v1

# Option: activer un profil nginx embarqué (TLS interne) => voir docker-compose + profils
ENABLE_EMBEDDED_NGINX=false

# ---- TLS interne (si ENABLE_EMBEDDED_NGINX=true) ----
# Chemins montés dans le container nginx (certs Let's Encrypt ou auto-signés)
NGINX_CERT_PATH=/etc/ssl/certs/fullchain.pem
NGINX_KEY_PATH=/etc/ssl/private/privkey.pem
SERVER_NAME=stratum.local

# ---- Logging / Divers ----
NODE_ENV=production

# ---- Sécurité supplémentaires (futures options) ----
# RATE_LIMIT_ENABLED=false
# CORS_ORIGINS=https://app.exemple.com

# ---- Backups ----
BACKUP_DIR=/opt/stratum_backups

# ---- Observabilité / Metrics ----
METRICS_ENABLED=true
PROMETHEUS_PORT=9090
GRAFANA_PORT=3100
METRICS_HTTP_SAMPLE_RATE=1.0
METRICS_ENTITY_SNAPSHOT_INTERVAL_MS=15000
METRICS_BACKUP_AGE_ENABLED=true
METRICS_EVENT_LOOP_INTERVAL_MS=5000

# ---- Ne pas exposer en clair en prod: utilisez un vault si possible ----
